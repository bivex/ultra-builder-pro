#!/bin/bash
# Session Summary Hook - ä¼šè¯ç»“æŸæ—¶è‡ªåŠ¨ç”Ÿæˆæ‘˜è¦
# åœ¨Claudeå®Œæˆå“åº”åŽè§¦å‘

set -e

# åˆ›å»ºä¼šè¯æ—¥å¿—ç›®å½•
SESSIONS_DIR="$HOME/.claude/sessions"
mkdir -p "$SESSIONS_DIR"

# ç”Ÿæˆæ—¶é—´æˆ³
TIMESTAMP=$(date '+%Y-%m-%d_%H-%M-%S')
LOG_FILE="$SESSIONS_DIR/session-$TIMESTAMP.log"

# è®°å½•ä¼šè¯åŸºæœ¬ä¿¡æ¯
cat > "$LOG_FILE" <<EOF
# Claude Code Session Summary

**Time**: $(date '+%Y-%m-%d %H:%M:%S')
**Duration**: [To be tracked]
**Working Directory**: $(pwd)

## Session Metadata
- Session ID: $TIMESTAMP
- User: $USER
- Host: $(hostname)

## Notes
Session ended. Full context available in conversation history.

---
Generated by Hooks mechanism
EOF

# æ¸…ç†æ—§æ—¥å¿—ï¼ˆä¿ç•™æœ€è¿‘30å¤©ï¼‰
find "$SESSIONS_DIR" -name "session-*.log" -mtime +30 -delete 2>/dev/null || true

# è¾“å‡ºç®€çŸ­é€šçŸ¥åˆ°stderrï¼ˆä¼šæ˜¾ç¤ºç»™ç”¨æˆ·ï¼‰
echo "ðŸ“Š Session logged: $LOG_FILE" >&2

exit 0
